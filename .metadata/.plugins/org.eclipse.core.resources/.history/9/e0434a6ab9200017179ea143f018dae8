package com.wbl.page;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

public class AmazonPrimePage {
	
	WebDriver driver;
	
	public AmazonPrimePage(WebDriver driver){
		
		this.driver = driver;
		
	}
	
	
	public String getPrime1() {
		
		
		
	/*	WebElement element = driver.findElement(By.xpath(".//a[contains(@class,'nav-prime-try')]"));
		
		Actions action = new Actions(driver);
		action.moveToElement(element).build().perform();
		
		driver.findElement(By.xpath(".//*[@id='nav-prime-tooltip'and @class='nav-template nav-flyout-content']")).click();
		
	*/ 
		
		driver.findElement(By.xpath(".//a[contains(@class,'nav-prime-try')]")).click(); // 'try prime' 
		
		
//		driver.findElement(By.cssSelector("span[id='popover-button-announce']")).click();  // 'see more plans'
		
		System.out.println("111111111111");
		
		Actions action = new Actions(driver);
		
		
		
		String currWindowName = driver.getWindowHandle(); //gives current window name
		
		Set<String> windows = driver.getWindowHandles(); // gives all currrent open  windows 
	
	for(String win : windows){
		
		System.out.println("the open window are :: " + win);
		
		/*if (win != currWindowName){
			//trying to switch control to child window
			driver.switchTo().window(win); 
		}   */
	 
	}
		
		
		
		
		WebDriverWait wait = new WebDriverWait(driver,35);
		wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath
				(".//span[contains(text(),'Start your 30-day ')]//following::input[@class='a-button-input']"))).click();

				
				
//				(".//span[contains(text(),'See more plans')]//preceding::input[@class='a-button-input']"))).click();
				
				
//				(".//input[@class='a-button-input']//following::span[contains(text(),'See more plans')]"))).click();
		
 //		  wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(" .//span[contains(text(),'See more plans')]"))).click();
//		action.moveToElement(element).click(element);
		
		System.out.println("222222222222");

		List<WebElement> buttons = new ArrayList<WebElement>();
		
	    wait = new WebDriverWait(driver,35);
 
 		System.out.println("3333333333333");

		
 		
	//	buttons = wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(By.cssSelector(".a-button-input")));
 		
 		buttons = wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy
				(By.xpath(".//i[contains(@class,'a-icon-radio-inactive')]")));
		
		
		System.out.println("444444444444 button size " + buttons.size());

		buttons.get(1).click();
		
		buttons = wait.until(ExpectedConditions.visibilityOfAllElementsLocatedBy(By.cssSelector(".a-button-input")));
		System.out.println("555555555 button size " + buttons.size());

		buttons.get(2).click();
 		
		System.out.println("");
		System.out.println("title : " + driver.getTitle());
		
		
		


	return driver.getTitle();	
		 
		
	}
	
	

}
